<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Testing Automation Framework</title>
  <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>ğŸ§ª Testing Automation Framework</h1>
      <p>Sistema de testing automatizado con Inteligencia Artificial</p>
    </header>

    <div class="tabs">
      <button class="tab-button active" onclick="showTab('dashboard')">ğŸ“Š Dashboard</button>
      <button class="tab-button" onclick="showTab('create')">â• Crear Test</button>
      <button class="tab-button" onclick="showTab('run')">â–¶ï¸ Ejecutar Test</button>
      <button class="tab-button" onclick="showTab('results')">ğŸ“ˆ Resultados</button>
      <button class="tab-button" onclick="showTab('natural')">ğŸ’¬ Tests Naturales</button>
    </div>

    <!-- Dashboard Tab -->
    <div id="dashboard" class="tab-content active">
      <div class="grid">
        <div class="card" style="grid-column: 1 / -1;">
          <h2>ğŸ¤– Modelo LLM Activo</h2>
          <div id="llm-selector" style="margin-top: 20px;">
            <div class="status">
              <div class="loading"></div>
              <span>Cargando...</span>
            </div>
          </div>
        </div>
      </div>

      <div class="grid">
        <div class="card">
          <h2>ğŸ“Š Tests Ejecutados</h2>
          <div id="test-statistics">
            <div class="status">
              <div class="loading"></div>
              <span>Cargando...</span>
            </div>
          </div>
        </div>

        <div class="card">
          <h2>ğŸ’» Sistema</h2>
          <div id="system-info">
            <div class="status">
              <div class="loading"></div>
              <span>Cargando...</span>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <h2>ğŸ”„ Tests en EjecuciÃ³n</h2>
        <div id="active-tests">
          <p style="color: #7f8c8d;">No hay tests en ejecuciÃ³n en este momento</p>
        </div>
      </div>
    </div>

    <!-- Create Test Tab -->
    <div id="create" class="tab-content">
      <div class="card">
        <h2>â• Crear Test desde Lenguaje Natural</h2>
        <p style="color: #7f8c8d; margin-bottom: 20px;">
          Describe en lenguaje natural lo que quieres probar. La IA generarÃ¡ el test automÃ¡ticamente.
        </p>

        <div id="create-alert"></div>

        <form id="create-test-form" onsubmit="createTest(event)">
          <div class="form-group">
            <label for="test-name">Nombre del Test *</label>
            <input type="text" id="test-name" placeholder="ej: Test de Login" required>
          </div>

          <div class="form-group">
            <label for="base-url">URL de la AplicaciÃ³n *</label>
            <input type="text" id="base-url" placeholder="https://www.ejemplo.com o localhost:3000" required>
            <small style="color: #7f8c8d; font-size: 0.9em;">
              ğŸ’¡ Puedes escribir con o sin https:// - se agregarÃ¡ automÃ¡ticamente
            </small>
          </div>

          <div class="form-group">
            <label for="instructions">Instrucciones en Lenguaje Natural *</label>
            <textarea id="instructions" placeholder="Ejemplo:
Abre la aplicaciÃ³n.
Haz click en el botÃ³n 'Login'.
Ingresa 'test@example.com' en el campo de email.
Ingresa 'password123' en el campo de contraseÃ±a.
Haz click en 'Enviar'.
Verifica que aparezca un mensaje de bienvenida." required></textarea>
          </div>

          <button type="submit" id="create-btn">
            ğŸ¤– Generar Test con IA
          </button>
          <button type="button" class="secondary" onclick="document.getElementById('create-test-form').reset()">
            ğŸ”„ Limpiar
          </button>
        </form>

        <div id="generated-test"></div>
      </div>
    </div>

    <!-- Run Test Tab -->
    <div id="run" class="tab-content">
      <div class="grid">
        <div class="card">
          <h2>ğŸ“‹ Seleccionar Test</h2>
          <input type="text" class="search-box" id="test-search" placeholder="ğŸ” Buscar test..." onkeyup="filterTests()">
          <div class="scrollable-list" id="test-selector">
            <div class="status">
              <div class="loading"></div>
              <span>Cargando tests...</span>
            </div>
          </div>
        </div>

        <div class="card">
          <h2>âš™ï¸ ConfiguraciÃ³n</h2>
          <div class="form-group">
            <label for="execution-mode">Modo de EjecuciÃ³n</label>
            <select id="execution-mode">
              <option value="auto">ğŸ”„ AutomÃ¡tico (HÃ­brido)</option>
              <option value="llm">ğŸ¤– LLM (Inteligente)</option>
              <option value="direct">âš¡ Directo (RÃ¡pido)</option>
            </select>
          </div>

          <button onclick="runSelectedTest()" id="run-btn">
            â–¶ï¸ Ejecutar Test
          </button>
        </div>
      </div>

      <div class="card">
        <h2>ğŸ“Š Estado de EjecuciÃ³n</h2>
        <div id="execution-status">
          <p style="color: #7f8c8d;">Selecciona y ejecuta un test para ver el progreso</p>
        </div>
      </div>

      <div class="card" id="execution-logs-card" style="display: none;">
        <h2>ğŸ“ Logs de EjecuciÃ³n</h2>
        <div class="log-console" id="execution-logs"></div>
      </div>
    </div>

    <!-- Results Tab -->
    <div id="results" class="tab-content">
      <div class="card">
        <h2>ğŸ“ˆ Reportes Generados</h2>
        <button onclick="loadResults()" class="secondary">ğŸ”„ Actualizar</button>
        <div id="results-list" style="margin-top: 20px;">
          <div class="status">
            <div class="loading"></div>
            <span>Cargando resultados...</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Natural Tests Tab -->
    <div id="natural" class="tab-content">
      <div class="grid">
        <!-- Crear Test Natural -->
        <div class="card">
          <h2>âœ¨ Crear Test en Lenguaje Natural</h2>
          <p style="color: #7f8c8d; margin-bottom: 20px;">
            Sin YAML, sin selectores CSS - solo instrucciones humanas
          </p>

          <div class="form-group">
            <label for="natural-name">Nombre del test:</label>
            <input type="text" id="natural-name" placeholder="ej: BÃºsqueda en MercadoLibre">
          </div>

          <div class="form-group">
            <label for="natural-url">URL inicial:</label>
            <input type="text" id="natural-url" placeholder="ej: https://mercadolibre.com.uy">
          </div>

          <div class="form-group">
            <label for="natural-description">DescripciÃ³n:</label>
            <input type="text" id="natural-description" placeholder="ej: Verifica bÃºsqueda de productos">
          </div>

          <div class="form-group">
            <label for="natural-instructions">Instrucciones (paso a paso):</label>
            <textarea id="natural-instructions" rows="8" placeholder="Ejemplo:

Navega a la URL inicial

Busca el cuadro de bÃºsqueda principal
Escribe 'laptops gaming'

Haz click en el botÃ³n de bÃºsqueda

Verifica que aparezcan resultados

Toma un screenshot"></textarea>
          </div>

          <div class="form-group">
            <label>Opciones avanzadas:</label>
            <div style="margin-top: 10px;">
              <label style="display: flex; align-items: center; margin-bottom: 8px;">
                <input type="checkbox" id="natural-screenshot" style="margin-right: 8px;">
                <span>ğŸ“¸ Screenshot despuÃ©s de cada paso</span>
              </label>
              <label style="display: flex; align-items: center; margin-bottom: 8px;">
                <input type="checkbox" id="natural-logs" checked style="margin-right: 8px;">
                <span>ğŸ“ Capturar logs de consola</span>
              </label>
              <label style="display: flex; align-items: center; margin-bottom: 8px;">
                <input type="checkbox" id="natural-network" style="margin-right: 8px;">
                <span>ğŸŒ Capturar requests de red</span>
              </label>
              <label style="display: flex; align-items: center; margin-bottom: 8px;">
                <input type="checkbox" id="natural-performance" style="margin-right: 8px;">
                <span>ğŸ“Š MÃ©tricas de rendimiento</span>
              </label>
            </div>
          </div>

          <div style="display: flex; gap: 10px; margin-top: 20px;">
            <button onclick="createNaturalTest()" style="flex: 1;">ğŸ’¾ Guardar Test</button>
            <button onclick="createAndRunNaturalTest()" class="primary" style="flex: 1;">â–¶ï¸ Guardar y Ejecutar</button>
          </div>
        </div>

        <!-- Tests Disponibles y EjecuciÃ³n -->
        <div class="card">
          <h2>ğŸ“„ Tests Naturales Disponibles</h2>
          <button onclick="loadNaturalTests()" class="secondary">ğŸ”„ Actualizar</button>

          <div id="natural-tests-list" style="margin-top: 20px;">
            <div class="status">
              <div class="loading"></div>
              <span>Cargando tests...</span>
            </div>
          </div>

          <div id="natural-execution-area" style="margin-top: 30px; display: none;">
            <h3 style="color: #2c3e50; margin-bottom: 15px;">â–¶ï¸ EjecuciÃ³n en Vivo</h3>
            <div id="natural-execution-status" class="status" style="margin-bottom: 15px;">
              <span>Preparado</span>
            </div>
            <div id="natural-execution-logs" style="background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 8px; max-height: 400px; overflow-y: auto; font-family: 'Courier New', monospace; font-size: 0.9em; line-height: 1.5;">
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="/js/main.js"></script>
</body>
</html>
